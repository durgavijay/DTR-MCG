<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DTR-MCG-PAS Integration Workflow Guide</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6; color: #333; max-width: 1200px; margin: 0 auto; padding: 20px; background: #f5f7fa; }
    h1 { color: #1a365d; border-bottom: 3px solid #3182ce; padding-bottom: 10px; margin-bottom: 20px; }
    h2 { color: #2c5282; margin-top: 30px; margin-bottom: 15px; padding: 10px; background: #ebf8ff; border-left: 4px solid #3182ce; }
    h3 { color: #2d3748; margin-top: 20px; margin-bottom: 10px; }
    h4 { color: #4a5568; margin-top: 15px; margin-bottom: 8px; }
    p { margin-bottom: 10px; }
    table { width: 100%; border-collapse: collapse; margin: 15px 0; background: white; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    th, td { border: 1px solid #e2e8f0; padding: 12px; text-align: left; }
    th { background: #4299e1; color: white; font-weight: 600; }
    tr:nth-child(even) { background: #f7fafc; }
    tr:hover { background: #edf2f7; }
    pre { background: #1a202c; color: #e2e8f0; padding: 15px; border-radius: 8px; overflow-x: auto; margin: 15px 0; font-size: 13px; }
    code { font-family: 'Consolas', 'Monaco', monospace; }
    .inline-code { background: #edf2f7; padding: 2px 6px; border-radius: 4px; font-size: 14px; color: #e53e3e; }
    .card { background: white; border-radius: 8px; padding: 20px; margin: 15px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .flow-diagram { background: #1a202c; color: #68d391; padding: 20px; border-radius: 8px; font-family: monospace; white-space: pre; overflow-x: auto; line-height: 1.4; }
    .badge { display: inline-block; padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 600; margin-right: 5px; }
    .badge-blue { background: #bee3f8; color: #2b6cb0; }
    .badge-green { background: #c6f6d5; color: #276749; }
    .badge-orange { background: #feebc8; color: #c05621; }
    .badge-red { background: #fed7d7; color: #c53030; }
    .badge-purple { background: #e9d8fd; color: #6b46c1; }
    .badge-yellow { background: #fefcbf; color: #975a16; }
    .section { margin-bottom: 30px; }
    .toc { background: white; padding: 20px; border-radius: 8px; margin-bottom: 30px; }
    .toc ul { list-style: none; padding-left: 0; }
    .toc li { padding: 5px 0; }
    .toc a { color: #3182ce; text-decoration: none; }
    .toc a:hover { text-decoration: underline; }
    .alert { padding: 15px; border-radius: 8px; margin: 15px 0; }
    .alert-info { background: #ebf8ff; border-left: 4px solid #3182ce; }
    .alert-warning { background: #fffaf0; border-left: 4px solid #dd6b20; }
    .alert-success { background: #f0fff4; border-left: 4px solid #38a169; }
    .alert-danger { background: #fff5f5; border-left: 4px solid #c53030; }
    .error-category { background: #2d3748; color: white; padding: 8px 15px; margin: 20px 0 10px 0; border-radius: 5px; font-weight: 600; }
    .question-box { background: #fffaf0; border: 2px dashed #ed8936; padding: 15px; border-radius: 8px; margin: 15px 0; }
    .question-box h4 { color: #c05621; margin-bottom: 10px; }
    .question-box ul { margin-left: 20px; }
    .question-box li { margin-bottom: 12px; color: #744210; }
    .answered-block { margin-top: 6px; background: #f0fff4; border-left: 3px solid #38a169; padding: 8px 12px; border-radius: 4px; color: #276749; }
    .workflow-container { position: relative; padding: 20px 0; }
    .workflow-step { display: flex; margin-bottom: 30px; position: relative; }
    .workflow-step:last-child { margin-bottom: 0; }
    .workflow-step::before { content: ''; position: absolute; left: 30px; top: 70px; bottom: -30px; width: 4px; background: linear-gradient(180deg, #667eea, #764ba2); border-radius: 2px; }
    .workflow-step:last-child::before { display: none; }
    .step-number { width: 60px; height: 60px; border-radius: 50%; background: linear-gradient(135deg, #667eea, #764ba2); color: white; display: flex; align-items: center; justify-content: center; font-size: 24px; font-weight: bold; flex-shrink: 0; z-index: 1; box-shadow: 0 4px 15px rgba(102,126,234,0.4); }
    .step-content { flex: 1; margin-left: 25px; background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); border-left: 4px solid #667eea; }
    .step-content h4 { color: #2d3748; margin-bottom: 10px; font-size: 18px; display: flex; align-items: center; gap: 10px; }
    .step-content p { color: #4a5568; margin-bottom: 10px; }
    .step-details { background: #f7fafc; border-radius: 8px; padding: 15px; margin-top: 15px; }
    .step-details h5 { color: #2d3748; margin-bottom: 10px; font-size: 14px; text-transform: uppercase; letter-spacing: 0.5px; }
    .step-details ul { margin-left: 20px; color: #4a5568; }
    .step-details li { margin-bottom: 5px; }
    .endpoint-box { background: #1a202c; color: #68d391; padding: 10px 15px; border-radius: 6px; font-family: monospace; margin: 10px 0; display: inline-block; }
    .data-flow { display: flex; align-items: center; gap: 10px; flex-wrap: wrap; margin: 10px 0; }
    .data-item { background: #e9d8fd; color: #553c9a; padding: 5px 12px; border-radius: 20px; font-size: 13px; font-weight: 500; }
    .arrow { color: #667eea; font-size: 20px; }
    .resource-bubbles-container { display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; padding: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; margin: 20px 0; }
    .resource-bubble { padding: 15px 25px; border-radius: 50px; font-weight: 600; font-size: 16px; cursor: pointer; transition: all 0.3s ease; border: 3px solid white; box-shadow: 0 4px 15px rgba(0,0,0,0.2); display: flex; align-items: center; gap: 8px; }
    .resource-bubble:hover { transform: translateY(-5px) scale(1.05); box-shadow: 0 8px 25px rgba(0,0,0,0.3); }
    .resource-bubble.active { transform: scale(1.1); box-shadow: 0 0 0 4px rgba(255,255,255,0.5), 0 8px 25px rgba(0,0,0,0.3); }
    .bubble-coverage { background: linear-gradient(135deg, #9f7aea, #805ad5); color: white; }
    .bubble-servicerequest { background: linear-gradient(135deg, #4299e1, #3182ce); color: white; }
    .bubble-patient { background: linear-gradient(135deg, #48bb78, #38a169); color: white; }
    .bubble-practitioner { background: linear-gradient(135deg, #ed8936, #dd6b20); color: white; }
    .bubble-location { background: linear-gradient(135deg, #fc8181, #e53e3e); color: white; }
    .bubble-encounter { background: linear-gradient(135deg, #f6e05e, #d69e2e); color: #744210; }
    .bubble-organization { background: linear-gradient(135deg, #4fd1c5, #319795); color: white; }
    .bubble-claim { background: linear-gradient(135deg, #667eea, #5a67d8); color: white; }
    .bubble-questionnaireresponse { background: linear-gradient(135deg, #ed64a6, #d53f8c); color: white; }
    .resource-panel { display: none; animation: slideDown 0.4s ease; background: white; border-radius: 12px; padding: 25px; margin-top: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.15); border-top: 5px solid #667eea; }
    .resource-panel.active { display: block; }
    .resource-panel h3 { display: flex; align-items: center; gap: 10px; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #e2e8f0; }
    .resource-panel-wrapper { position: relative; }
    .close-btn { position: absolute; top: 15px; right: 20px; background: #e53e3e; color: white; border: none; border-radius: 50%; width: 30px; height: 30px; cursor: pointer; font-size: 18px; display: flex; align-items: center; justify-content: center; }
    @keyframes slideDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
    .mapping-table th { background: #667eea; }
    .mapping-table tr:hover { background: #e9d8fd; }
    .pas-mapping-table th { background: #38a169; color: white; font-weight: 600; }
    .pas-mapping-table tr:hover { background: #c6f6d5; }
    .payload-pre { max-height: 560px; overflow-y: auto; overflow-x: auto; background: #1a202c; color: #e2e8f0; padding: 15px; border-radius: 8px; font-size: 12px; font-family: 'Consolas','Monaco',monospace; white-space: pre; margin: 0; line-height: 1.5; }
    @media print { body { background: white; } .card { box-shadow: none; border: 1px solid #e2e8f0; } }
  </style>
</head>
<body>

<h1>ğŸ¥ DTR-MCG-PAS Integration Workflow Guide</h1>

<div class="toc card">
  <h3>ğŸ“‹ Table of Contents</h3>
  <ul>
    <li><a href="#overview">1. Overview</a></li>
    <li><a href="#architecture">2. Architecture</a></li>
    <li><a href="#e2e-workflow">3. End-to-End Integration Workflow</a></li>
    <li><a href="#resource-mappings">4. Resource Mappings for $questionnaire-package</a></li>
    <li><a href="#mcg-rule-types">5. MCG Rule Types</a></li>
    <li><a href="#prerequisites">6. Pre-Requisites: Admin Site Configuration</a></li>
    <li><a href="#pas-resource-mappings">7. Resource Mappings for PAS $submit</a></li>
    <li><a href="#dtr-phase">8. Phase 1: DTR (Documentation Templates and Rules)</a></li>
    <li><a href="#questionnaire-response">9. Phase 2: Build QuestionnaireResponse</a></li>
    <li><a href="#pas-phase">10. Phase 3: PAS (Prior Authorization Support)</a></li>
    <li><a href="#validation-errors">11. Common Validation Errors &amp; Solutions</a></li>
    <li><a href="#complete-flow">12. Complete Flow Diagram</a></li>
    <li><a href="#best-practices">13. Best Practices</a></li>
    <li><a href="#api-summary">14. API Endpoints Summary</a></li>
    <li><a href="#identifiers">15. Key Identifiers to Track</a></li>
    <li><a href="#sample-payload">16. Sample PAS $submit Payload</a></li>
  </ul>
</div>

<!-- ==================== SECTION 1 ==================== -->
<div id="overview" class="section">
  <h2>1. Overview</h2>
  <div class="card">
    <p>This document covers the complete workflow for integrating with MCG's DTR (Documentation Templates and Rules) and PAS (Prior Authorization Support) APIs for healthcare prior authorization.</p>
    <div class="alert alert-info">
      <strong>Key Components:</strong>
      <ul style="margin-top:10px;margin-left:20px;">
        <li><strong>DTR</strong> - Retrieve clinical questionnaires and collect documentation</li>
        <li><strong>PAS</strong> - Submit prior authorization requests and receive decisions</li>
      </ul>
    </div>
  </div>
</div>

<!-- ==================== SECTION 2 ==================== -->
<div id="architecture" class="section">
  <h2>2. Architecture Overview</h2>
  <div class="card">
    <div class="flow-diagram">
+-------------------+         +-------------------+         +-------------------+
|                   |         |                   |         |                   |
|  Provider System  |         |     MCG APIs      |         |   Payer System    |
|     (EHR/EMR)     |  -----> |      (DTR)        |  -----> |   (GuidingCare)   |
|                   |         |                   |         |                   |
|  - ServiceRequest |         |  - $questionnaire |         |  - Auth Decision  |
|  - Patient Data   |  <----- |  - $next-question |  <----- |  - ClaimResponse  |
|  - Coverage Info  |         |                   |         |  - preAuthRef     |
|                   |         |                   |         |                   |
+-------------------+         +-------------------+         +-------------------+</div>
  </div>
</div>

<!-- ==================== SECTION 3 ==================== -->
<div id="e2e-workflow" class="section">
  <h2>3. End-to-End Integration Workflow</h2>
  <div class="alert alert-info"><strong>ğŸ“Œ This section describes the complete flow from Provider submission to displaying guideline outcomes</strong></div>
  <div class="workflow-container">
    <div class="workflow-step">
      <div class="step-number">1</div>
      <div class="step-content">
        <h4>ğŸ“¤ Provider Sends Claim to GuidingCare</h4>
        <p>The Provider system (EHR/EMR) sends a Claim payload to GuidingCare via the POST Claim endpoint. If there is any guideline-related information collected from the DTR flow, the provider includes the <strong>QuestionnaireResponse</strong> resource in the payload.</p>
        <div class="endpoint-box">POST /Claim/$submit â†’ GuidingCare</div>
        <div class="step-details">
          <h5>ğŸ“¦ Payload Contents</h5>
          <ul>
            <li><strong>Claim</strong> - The prior authorization request with CPT codes, diagnosis codes</li>
            <li><strong>Coverage</strong> - Patient insurance information</li>
            <li><strong>Patient</strong> - Patient demographics</li>
            <li><strong>Practitioner(s)</strong> - Requesting and attending providers</li>
            <li><strong>Location</strong> - Facility Provider</li>
            <li><strong>Organization</strong> - Payer organization</li>
            <li><strong>QuestionnaireResponse</strong> (if applicable) - Clinical answers from DTR questionnaire</li>
          </ul>
        </div>
        <div class="data-flow">
          <span class="data-item">Provider EHR</span><span class="arrow">â†’</span>
          <span class="data-item">Claim Bundle</span><span class="arrow">â†’</span>
          <span class="data-item">GuidingCare PAS Claim API</span>
        </div>
      </div>
    </div>
    <div class="workflow-step">
      <div class="step-number">2</div>
      <div class="step-content">
        <h4>ğŸ”„ GuidingCare Builds MCG Payload &amp; Calls MCG's PAS Submit</h4>
        <p>GuidingCare receives the Claim payload, transforms it into the MCG-required format, and sends it to the <strong>MCG PAS Submit</strong> endpoint. The response contains the <strong>disposition</strong> (decision status) and <strong>Episode ID</strong>.</p>
        <div class="endpoint-box">POST /Claim/$submit â†’ MCG PAS API</div>
        <div class="step-details">
          <h5>ğŸ”§ Transformation Steps</h5>
          <ul>
            <li>Extract resources from incoming Claim bundle</li>
            <li>Map GuidingCare fields to MCG FHIR format</li>
            <li>Build PAS Request Bundle with proper profiles</li>
            <li>Wrap QuestionnaireResponse in DTR-QRBundle (nested bundle)</li>
            <li>Add required extensions (serviceItemRequestType, certificationType)</li>
          </ul>
        </div>
        <div class="step-details" style="margin-top:15px;">
          <h5>ğŸ“¥ Response from MCG PAS</h5>
          <ul>
            <li><strong>ClaimResponse</strong> - Contains authorization decision</li>
            <li><strong>disposition</strong> - Decision status (Approved/Denied/Pended)</li>
            <li><strong>preAuthRef</strong> - Authorization reference number</li>
            <li><strong>Episode ID</strong> - MCG case tracking identifier (captured for next step)</li>
          </ul>
        </div>
        <div class="data-flow">
          <span class="data-item">GuidingCare</span><span class="arrow">â†’</span>
          <span class="data-item">MCG PAS Bundle</span><span class="arrow">â†’</span>
          <span class="data-item">MCG PAS API</span><span class="arrow">â†’</span>
          <span class="data-item">ClaimResponse + Episode ID</span>
        </div>
        <table style="margin-top:15px;">
          <tr><th>Disposition</th><th>Meaning</th><th>Action</th></tr>
          <tr><td><span class="badge badge-green">Approved</span></td><td>Authorization granted</td><td>Proceed with service</td></tr>
          <tr><td><span class="badge badge-red">Denied</span></td><td>Authorization rejected</td><td>Review reasons, appeal if needed</td></tr>
          <tr><td><span class="badge badge-orange">Pended</span></td><td>Needs manual review</td><td>Wait for reviewer decision</td></tr>
        </table>
      </div>
    </div>
     <div class="workflow-step">
      <div class="step-number">3</div>
      <div class="step-content">
        <h4><span class="step-icon">ğŸ“Š</span> Call MCG CareWebQI, Display Guideline Outcomes &amp; Update Service Lines</h4>
        <p>Using the <strong>Episode ID</strong> captured from Step 2, GuidingCare calls the <strong>MCG CareWebQI</strong> endpoint to retrieve detailed guideline evaluation outcomes. The outcomes are displayed in the <strong>Decision &gt;&gt; Run Guidelines</strong> section of the GuidingCare UI for all service lines. Additionally, depending on the disposition, GuidingCare must also <strong>update the service line values</strong> directly.</p>
        <div class="endpoint-box">GET /CareWebQI/{episodeId} â†’ MCG CareWebQI API</div>
        <div class="step-details">
          <h5>ğŸ“‹ CareWebQI Response Contains</h5>
          <ul>
            <li><strong>Guideline Name</strong> - Which clinical guideline was evaluated</li>
            <li><strong>Guideline Version</strong> - Version of the guideline used</li>
            <li><strong>Outcome Status</strong> - Met/Not Met/Partially Met</li>
            <li><strong>Indication Details</strong> - Which criteria were satisfied</li>
            <li><strong>Missing Information</strong> - What additional info might be needed</li>
            <li><strong>Clinical Rationale</strong> - Explanation for the decision</li>
          </ul>
        </div>
        <div class="step-details" style="margin-top:15px;">
          <h5>ğŸ”„ Service Line Update Logic â€” Based on Disposition</h5>
          <table style="margin-top:8px;">
            <tr><th>Disposition</th><th>Show in Run Guidelines?</th><th>Update Service Line?</th><th>What Gets Updated</th></tr>
            <tr><td><span class="badge badge-orange">Pended / Pending</span></td><td>âœ… Yes</td><td>âŒ No</td><td>Only shown in guidelines section; service line values remain unchanged</td></tr>
            <tr><td><span class="badge badge-green">Approved</span></td><td>âœ… Yes</td><td>âœ… Yes</td><td>Decision status, requested units, and relevant service line fields must be updated</td></tr>
            <tr><td><span class="badge badge-red">Denied</span></td><td>âœ… Yes</td><td>âœ… Yes</td><td>Decision status, requested units, and relevant service line fields must be updated</td></tr>
            <tr><td><span class="badge badge-purple">Partial</span></td><td>âœ… Yes</td><td>âœ… Yes</td><td>Decision status, requested units, and relevant service line fields must be updated</td></tr>
          </table>
        </div>
        <div class="alert alert-warning" style="margin-top:15px;">
          <strong>âš ï¸ Key Rule:</strong> If the disposition is <strong>Pended/Pending</strong>, only display the guideline outcome in the Run Guidelines section â€” do not update the service line. For <strong>Approved, Denied, or Partial</strong> dispositions, the guideline outcome must be shown <em>and</em> the corresponding service line decision status, requested units, and other values must be updated accordingly.
        </div>
       <div class="data-flow">
          <span class="data-item">Access authorization</span><span class="arrow">â†’</span>
          <span class="data-item">Edit decision</span><span class="arrow">â†’</span>
          <span class="data-item">Run guidelines</span><span class="arrow">â†’</span>
          <span class="data-item">Need to see episode ID for all service lines</span>
        </div>

      </div>
    </div>
  </div>

 <div class="card" style="margin-top:30px;">
    <h3>ğŸ”‘ Key Data to Track Across Steps</h3>
    <table>
      <tr><th>Step</th><th>Input</th><th>Output to Capture</th><th>Used In</th></tr>
      <tr><td><span class="badge badge-blue">Step 1</span></td><td>Claim Bundle from Provider</td><td>All resources, QuestionnaireResponse</td><td>Step 2 - Build MCG payload</td></tr>
      <tr><td><span class="badge badge-purple">Step 2</span></td><td>MCG PAS Request Bundle</td><td><strong>Episode ID</strong>, disposition, preAuthRef</td><td>Step 3 - CareWebQI call</td></tr>
      <tr><td><span class="badge badge-green">Step 3</span></td><td>Episode ID</td><td>Guideline outcomes, indication status</td><td>Run Decision Screen display</td></tr>
    </table>
  </div>
</div>



<!-- ==================== SECTION 4 ==================== -->
<div id="resource-mappings" class="section">
  <h2>4. Resource Mappings for $questionnaire-package</h2>
  <div class="alert alert-info"><strong>ğŸ“Œ Click on any resource bubble below to view its field mappings and open questions</strong></div>

  <div id="section4-bubbles" class="resource-bubbles-container">
    <div class="resource-bubble bubble-coverage"       onclick="showPanel('coverage')">ğŸ›¡ï¸ Coverage</div>
    <div class="resource-bubble bubble-servicerequest" onclick="showPanel('servicerequest')">ğŸ“‹ ServiceRequest</div>
    <div class="resource-bubble bubble-patient"        onclick="showPanel('patient')">ğŸ‘¤ Patient</div>
    <div class="resource-bubble bubble-practitioner"   onclick="showPanel('practitioner')">ğŸ‘¨â€âš•ï¸ Practitioner</div>
    <div class="resource-bubble bubble-location"       onclick="showPanel('location')">ğŸ“ Location</div>
    <div class="resource-bubble bubble-encounter"      onclick="showPanel('encounter')">ğŸ¥ Encounter</div>
    <div class="resource-bubble bubble-organization"   onclick="showPanel('organization')">ğŸ¢ Organization</div>
  </div>

  <!-- Coverage Panel -->
  <div class="resource-panel-wrapper">
    <div id="panel-coverage" class="resource-panel">
      <button class="close-btn" onclick="hidePanel('coverage')">Ã—</button>
      <h3>ğŸ›¡ï¸ Coverage Resource Mappings</h3>
      <table class="mapping-table">
        <tr><th>FHIR Element</th><th>GuidingCare Source</th><th>Notes</th></tr>
	<tr><td><span class="inline-code">type</span></td><td>LOB</td><td>On which LOB serviceRequest is requesting</td></tr>
        <tr><td><span class="inline-code">subscriber</span></td><td>Patient reference</td><td>Reference to Patient resource</td></tr>
        <tr><td><span class="inline-code">subscriberId</span></td><td>MAC configuration for Member ID</td><td>Member ID configured in MAC</td></tr>
        <tr><td><span class="inline-code">beneficiary</span></td><td>Patient reference</td><td>Use if relationship is "self"</td></tr>
        <tr><td><span class="inline-code">payor</span></td><td>Organization reference</td><td>Reference to payer Organization resource</td></tr>
        <tr><td><span class="inline-code">class.type.code</span></td><td>"plan"</td><td>Fixed value</td></tr>
        <tr><td><span class="inline-code">class.value</span></td><td>Benefit Plan Name</td><td>From eligibility record</td></tr>
	 <tr><td><span class="inline-code">class.type.code</span></td><td>"subplan"</td><td>Fixed value</td></tr>
        <tr><td><span class="inline-code">class.value</span></td><td>Benefit Product Plan Name</td><td>Data root name in GC</td></tr>
        <tr><td><span class="inline-code">period.start</span></td><td>Eligibility Start Date</td><td>Policy effective start date</td></tr>
        <tr><td><span class="inline-code">period.end</span></td><td>Eligibility End Date</td><td>Policy effective end date</td></tr>
      </table>
	<div class="alert alert-info" style="margin-top:12px;"><strong>Resource References:</strong> patient, Organization</div>
  </div>

  <!-- ServiceRequest Panel -->
  <div class="resource-panel-wrapper">
    <div id="panel-servicerequest" class="resource-panel">
      <button class="close-btn" onclick="hidePanel('servicerequest')">Ã—</button>
      <h3>ğŸ“‹ ServiceRequest Resource Mappings</h3>
      <table class="mapping-table">
        <tr><th>FHIR Element</th><th>GuidingCare Source</th><th>Notes</th></tr>
        <tr><td><span class="inline-code">code.coding.code</span></td><td>Procedure Code</td><td>CPT/HCPCS code</td></tr>
        <tr><td><span class="inline-code">subject</span></td><td>Patient reference</td><td>Reference to Patient resource</td></tr>
        <tr><td><span class="inline-code">requester</span></td><td>Requesting Provider</td><td>Practitioner reference</td></tr>
        <tr><td><span class="inline-code">performer</span></td><td>Attending Provider</td><td>Practitioner reference</td></tr>
        <tr><td><span class="inline-code">locationReference</span></td><td>Facility Provider</td><td>Location reference</td></tr>
        <tr><td><span class="inline-code">insurance</span></td><td>Coverage reference</td><td>Reference to Coverage resource</td></tr>
        <tr><td><span class="inline-code">authoredOn</span></td><td>Requested Date of Service</td><td>Date authorization was requested</td></tr>
	<tr><td><span class="inline-code">reasonCode</span></td><td>Diagnosis codes</td><td>Diagnosis codes against service request</td></tr>
      </table>
 	<div class="alert alert-info" style="margin-top:12px;"><strong>Resource References:</strong> patient, 2-practitoners, location, coverage, encounter</div>
      <div class="question-box">
        <h4>â“ Open Questions</h4>
        <ul>
          <li><strong>Quantity mapping:</strong> Need to confirm which GC field maps to ServiceRequest.quantity</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Patient Panel -->
  <div class="resource-panel-wrapper">
    <div id="panel-patient" class="resource-panel">
      <button class="close-btn" onclick="hidePanel('patient')">Ã—</button>
      <h3>ğŸ‘¤ Patient Resource Mappings</h3>
      <table class="mapping-table">
        <tr><th>FHIR Element</th><th>GuidingCare Source</th><th>Notes</th></tr>
        <tr><td><span class="inline-code">identifier.value</span></td><td>Patient MRN</td><td>Use "MR" as identifier type code</td></tr>
        <tr><td><span class="inline-code">name.given</span></td><td>First Name</td><td>Copy from GC Patient resource</td></tr>
        <tr><td><span class="inline-code">name.family</span></td><td>Last Name</td><td>Copy from GC Patient resource</td></tr>
        <tr><td><span class="inline-code">gender</span></td><td>Gender</td><td>Copy from GC Patient FHIR API</td></tr>
        <tr><td><span class="inline-code">address</span></td><td>Address</td><td>Copy from GC Patient FHIR API</td></tr>
      </table>
    </div>
  </div>

  <!-- Practitioner Panel -->
  <div class="resource-panel-wrapper">
    <div id="panel-practitioner" class="resource-panel">
      <button class="close-btn" onclick="hidePanel('practitioner')">Ã—</button>
      <h3>ğŸ‘¨â€âš•ï¸ Practitioner Resource Mappings</h3>
      <table class="mapping-table">
        <tr><th>FHIR Element</th><th>GuidingCare Source</th><th>Notes</th></tr>
        <tr><td><span class="inline-code">identifier.value</span></td><td>NPI</td><td>National Provider Identifier</td></tr>
        <tr><td><span class="inline-code">identifier.system</span></td><td>"http://hl7.org/fhir/sid/us-npi"</td><td>Fixed NPI system URL</td></tr>
        <tr><td><span class="inline-code">name</span></td><td>Provider Name</td><td>Copy from GC Practitioner resource</td></tr>
        <tr><td><span class="inline-code">address</span></td><td>Address</td><td>Copy from GC Practitioner resource</td></tr>
      </table>
<div class="alert alert-info" style="margin-top:12px;"><strong>Note:</strong>  
          <li>Facility Provider [GC] â†’ location reference [MCG]</li>
          <li>ReferredBy Provider [GC] â†’ servicerequest.requester [MCG]</li>
          <li>Admitting Provider [GC] â†’ servicerequest.performer [MCG]</li>
</div>
     </div>

  <!-- Location Panel -->
  <div class="resource-panel-wrapper">
    <div id="panel-location" class="resource-panel">
      <button class="close-btn" onclick="hidePanel('location')">Ã—</button>
      <h3>ğŸ“ Location Resource Mappings</h3>
      <table class="mapping-table">
        <tr><th>FHIR Element</th><th>GuidingCare Source</th><th>Notes</th></tr>
	<tr><td><span class="inline-code">identifier</span></td><td>NPI value</td><td>Facility Provider NPI</td></tr>
        <tr><td><span class="inline-code">type.coding.code</span></td><td>Place of Service Code</td><td>CMS Place of Service code</td></tr>
        <tr><td><span class="inline-code">name</span></td><td>Facility Name</td><td>From facility provider</td></tr>
        <tr><td><span class="inline-code">address</span></td><td>Facility Address</td><td>From facility provider</td></tr>
      </table>
     </div>

  <!-- Encounter Panel -->
  <div class="resource-panel-wrapper">
    <div id="panel-encounter" class="resource-panel">
      <button class="close-btn" onclick="hidePanel('encounter')">Ã—</button>
      <h3>ğŸ¥ Encounter Resource Mappings</h3>
      <table class="mapping-table">
        <tr><th>FHIR Element</th><th>GuidingCare Source</th><th>Notes</th></tr>
        <tr><td><span class="inline-code">class.code</span></td><td>Authorization.RequestedLevelOfCare</td><td>Level of care (IMP, AMB, EMER, etc.)</td></tr>
	<tr><td><span class="inline-code">serviceType.code</span></td><td>Service Type</td><td>Service type values</td></tr>
        <tr><td><span class="inline-code">status</span></td><td>"planned"</td><td>Fixed value for PA requests</td></tr>
        <tr><td><span class="inline-code">subject</span></td><td>Patient reference</td><td>Reference to Patient resource</td></tr>
      </table>
      </div>
  </div>

  <!-- Organization Panel -->
  <div class="resource-panel-wrapper">
    <div id="panel-organization" class="resource-panel">
      <button class="close-btn" onclick="hidePanel('organization')">Ã—</button>
      <h3>ğŸ¢ Organization Resource Mappings</h3>
      <table class="mapping-table">
        <tr><th>FHIR Element</th><th>GuidingCare Source</th><th>Notes</th></tr>
        <tr><td><span class="inline-code">identifier.value</span></td><td>NPI</td><td>Organization NPI</td></tr>
        <tr><td><span class="inline-code">name</span></td><td>Organization Name</td><td>Payer/Insurer name</td></tr>
        <tr><td><span class="inline-code">type.coding.code</span></td><td>"pay"</td><td>For payer organizations</td></tr>
        <tr><td><span class="inline-code">address</span></td><td>Address</td><td>Organization address</td></tr>
      </table>
      <div class="alert alert-info" style="margin-top:15px;"><strong>ğŸ“Œ Note:</strong> Organization is referenced by Coverage.payor for the payer/insurer. Need to see the GuidingCare mapping.</div>
    </div>
  </div>
</div>

<!-- ==================== SECTION 5 ==================== -->
<div id="mcg-rule-types" class="section">
  <h2>5. MCG Rule Types</h2>
  <div class="alert alert-info"><strong>ğŸ“Œ Overview:</strong> MCG supports 3 types of rules that operate at different phases of the DTR-MCG-PAS integration.</div>
  <div class="card">
    <h3>ğŸ—‚ï¸ Rule Types at a Glance</h3>
    <table>
      <tr><th>Rule Type</th><th>Triggered By</th><th>API Endpoint</th><th>Output</th></tr>
      <tr><td><span class="badge badge-blue">Pre Guideline</span></td><td>DTR Questionnaire Package request</td><td><span class="inline-code">$questionnaire-package</span></td><td>Standard or Adaptive Questionnaire</td></tr>
      <tr><td><span class="badge badge-green">Post Guideline</span></td><td>PAS Submit request</td><td><span class="inline-code">Claim/$submit</span></td><td>Disposition (Approved / Denied / Pended etc.)</td></tr>
      <tr><td><span class="badge badge-orange">Submit Phase</span></td><td>PAS Submit request</td><td><span class="inline-code">Claim/$submit</span></td><td>Status change from Pended â†’ Pending</td></tr>
    </table>
  </div>
</div>
 <div class="workflow-container" style="margin-top:10px;">
    <div class="workflow-step">
      <div class="step-number" style="background:linear-gradient(135deg,#4299e1,#3182ce);">1</div>
      <div class="step-content" style="border-left-color:#4299e1;">
        <h4><span class="step-icon">ğŸ“‹</span> Pre Guideline Rule</h4>
        <p>Evaluated during the <strong>DTR phase</strong> when <span class="inline-code">$questionnaire-package</span> is called. Returns either a Standard or Adaptive questionnaire.</p>
        <table style="margin-top:15px;">
          <tr><th>Rule Outcome</th><th>Questionnaire Type</th><th>Profile</th></tr>
          <tr><td>Single guideline match</td><td><span class="badge badge-green">Standard</span></td><td><span class="inline-code">dtr-std-questionnaire</span></td></tr>
          <tr><td>Multiple guideline matches</td><td><span class="badge badge-orange">Adaptive</span></td><td><span class="inline-code">dtr-questionnaire-adapt</span></td></tr>
        </table>
      </div>
    </div>
    <div class="workflow-step">
      <div class="step-number" style="background:linear-gradient(135deg,#48bb78,#38a169);">2</div>
      <div class="step-content" style="border-left-color:#48bb78;">
        <h4><span class="step-icon">âœ…</span> Post Guideline Rule</h4>
        <p>Evaluated during the <strong>PAS phase</strong> on <span class="inline-code">Claim/$submit</span>. Returns a <strong>disposition</strong> â€” the decision status of the authorization.</p>
        <div class="alert alert-warning" style="margin-top:15px;"><strong>âš ï¸ Admin Site Dependency (Pre-Requisite P4):</strong> The disposition must be configured in Admin Site â†’ Customize â†’ Admin Request to display on the authorization summary screen.</div>
      </div>
    </div>
    <div class="workflow-step">
      <div class="step-number" style="background:linear-gradient(135deg,#ed8936,#dd6b20);">3</div>
      <div class="step-content" style="border-left-color:#ed8936;">
        <h4><span class="step-icon">ğŸ”„</span> Submit Phase Rule</h4>
        <p>Also runs during the <strong>PAS phase</strong>. Handles the status transition from <strong>Pended</strong> (MCG disposition) â†’ <strong>Pending</strong> (GuidingCare internal status for manual review queue).</p>
        <div class="alert alert-warning" style="margin-top:15px;"><strong>âš ï¸ Admin Site Dependency (Pre-Requisite P4):</strong> The "Pending" status must also be configured in Admin Site â†’ Customize â†’ Admin Request.</div>
        <table style="margin-top:15px;">
          <tr><th>From (MCG Disposition)</th><th>To (GuidingCare Status)</th></tr>
          <tr><td><span class="badge badge-orange">Pended</span></td><td><span class="badge badge-yellow">Pending</span></td></tr>
        </table>
      </div>
    </div>
  </div>
  <div class="card" style="margin-top:10px;">
    <h3>ğŸ”„ Rule Types in the Integration Flow</h3>
    <div class="flow-diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              DTR PHASE ($questionnaire-package)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  PRE GUIDELINE RULE evaluates incoming request              â”‚
â”‚        â”‚                                                    â”‚
â”‚        â–¼                                                    â”‚
â”‚  Single match â†’ Standard QR                                 â”‚
â”‚  Multiple matches â†’ Adaptive QR                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚  (QuestionnaireResponse built &amp; submitted)
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  PAS PHASE (Claim/$submit)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  POST GUIDELINE RULE â†’ Disposition (Approved/Denied/Pended) â”‚
â”‚  âš  Must be configured in Admin Site â†’ Admin Request (P4)   â”‚
â”‚        â”‚  (if Pended)                                       â”‚
â”‚        â–¼                                                    â”‚
â”‚  SUBMIT PHASE RULE â†’ Pended â†’ Pending (review queue)       â”‚
â”‚  âš  "Pending" must be configured in Admin Site (P4)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>
  </div>
</div>


<!-- ==================== SECTION 6 ==================== -->
<div id="prerequisites" class="section">
  <h2>6. Pre-Requisites: Admin Site Configuration for DTR-MCG</h2>
  <div class="alert alert-warning"><strong>âš ï¸ Important:</strong> Before working on DTR-MCG integration, the following configurations <strong>must be verified or set up</strong> in the Admin Site.</div>
<div class="workflow-container">
    <div class="workflow-step">
      <div class="step-number" style="background:linear-gradient(135deg,#e53e3e,#c53030);font-size:18px;">P1</div>
      <div class="step-content" style="border-left-color:#e53e3e;">
        <h4><span class="step-icon">âš™ï¸</span> Rules Configuration in Admin Site</h4>
        <p>For DTR-MCG rules to work, the rules must first be <strong>configured in the Admin Site</strong>. Without this setup, no guideline evaluation will be triggered.</p>
<div style="margin-top:12px;background:#1a202c;color:#68d391;padding:12px 16px;border-radius:8px;font-family:monospace;font-size:14px;">Login to Admin Site â†’ Click Admin â†’ Click Configuration â†’ Click Rule Adminstrator</div>
      </div>
    </div>
    <div class="workflow-step">
      <div class="step-number" style="background:linear-gradient(135deg,#e53e3e,#c53030);font-size:18px;">P2</div>
      <div class="step-content" style="border-left-color:#e53e3e;">
        <h4><span class="step-icon">ğŸ”—</span> Service Type &amp; Level of Care Association</h4>
        <p>Rules in DTR-MCG operate based on the <strong>Service Type</strong> and <strong>Level of Care</strong> association configured in the Admin Site.</p>
        <div style="margin-top:12px;background:#1a202c;color:#68d391;padding:12px 16px;border-radius:8px;font-family:monospace;font-size:14px;">Login to Admin Site â†’ Click Admin â†’ Click Customize â†’ Click the link in Customize Collaborative Care Configurations</div>
        <div class="alert alert-warning" style="margin-top:12px;"><strong>âš ï¸</strong> If the Service Type and Level of Care combination is not associated, the DTR rule will <strong>not</strong> be triggered.</div>
      </div>
    </div>
    <div class="workflow-step">
      <div class="step-number" style="background:linear-gradient(135deg,#e53e3e,#c53030);font-size:18px;">P3</div>
      <div class="step-content" style="border-left-color:#e53e3e;">
        <h4><span class="step-icon">ğŸ·ï¸</span> Line of Business (LOB) Configuration</h4>
        <p>To view the <strong>LOB</strong> passed in the authorization summary, that LOB value must be pre-configured in the Admin Site.</p>
        <div style="margin-top:12px;background:#1a202c;color:#68d391;padding:12px 16px;border-radius:8px;font-family:monospace;font-size:14px;">Login to Admin Site â†’ Click Admin â†’ Click Customize â†’ Customize Line Of Business</div>
        <div class="alert alert-info" style="margin-top:12px;"><strong>Note:</strong> The LOB value in <span class="inline-code">coverage.type</span> must <strong>exactly match</strong> the configured value in the Admin Site.</div>
      </div>
    </div>
    <div class="workflow-step">
      <div class="step-number" style="background:linear-gradient(135deg,#e53e3e,#c53030);font-size:18px;">P4</div>
      <div class="step-content" style="border-left-color:#e53e3e;">
        <h4><span class="step-icon">ğŸ“‹</span> Disposition Status Configuration</h4>
        <p>The <strong>disposition</strong> from MCG (e.g., Pending, Approved, Denied) will only display on the authorization if the corresponding status is configured in the Admin Site.</p>
        <div style="margin-top:12px;background:#1a202c;color:#68d391;padding:12px 16px;border-radius:8px;font-family:monospace;font-size:14px;">Login to Admin Site â†’ Click Admin â†’ Click Customize â†’ Click Customize Auto Authorization Dropdowns â†’ Click Auto-Auth Request Status</div>
        <table style="margin-top:15px;">
          <tr><th>MCG Disposition</th><th>Meaning</th><th>Must be Configured?</th></tr>
          <tr><td><span class="badge badge-green">Approved</span></td><td>Authorization granted</td><td>âœ… Yes</td></tr>
          <tr><td><span class="badge badge-red">Denied</span></td><td>Authorization rejected</td><td>âœ… Yes</td></tr>
          <tr><td><span class="badge badge-orange">Pended</span></td><td>Needs manual review</td><td>âœ… Yes</td></tr>
        </table>
      </div>
    </div>
  </div>
  <div class="card" style="border-left:4px solid #e53e3e;">
    <h3>âœ… Pre-Requisite Checklist</h3>
    <table>
      <tr><th>#</th><th>Pre-Requisite</th><th>Admin Site Navigation</th><th>Impact if Missing</th></tr>
      <tr><td><span class="badge badge-red">P1</span></td><td>Rules configured in Admin Site</td><td>Login to Admin Site â†’ Click Admin â†’ Click Configuration â†’ Click Rule Adminstrator</td><td>No guideline evaluation triggered</td></tr>
      <tr><td><span class="badge badge-red">P2</span></td><td>Service Type &amp; Level of Care Association</td><td>Login to Admin Site â†’ Click Admin â†’ Click Customize â†’ Click the link in Customize Collaborative Care Configurations
</td><td>PAS API will throw error if no match found</td></tr>
      <tr><td><span class="badge badge-red">P3</span></td><td>LOB (Line of Business) configured</td><td>Login to Admin Site â†’ Click Admin â†’ Click Customize â†’ Customize Line Of Business</td><td>LOB not visible in authorization summary</td></tr>
      <tr><td><span class="badge badge-red">P4</span></td><td>Disposition status configured</td><td>Login to Admin Site â†’ Click Admin â†’ Click Customize â†’ Click Customize Auto Authorization Dropdowns â†’ Click Auto-Auth Request Status</td><td>Disposition wil not display correctly in the response from MCG PAS API</td></tr>
    </table>
  </div>
</div>

<!-- ==================== SECTION 7 ==================== -->
<div id="pas-resource-mappings" class="section">
  <h2>7. Resource Mappings for PAS $submit</h2>
  <div class="alert alert-success"><strong>ğŸ“Œ Click on any resource bubble below to view its field mappings</strong></div>
  <div id="section7-bubbles" class="resource-bubbles-container">
    <div class="resource-bubble bubble-claim"               onclick="showPasPanel('pas-claim')">ğŸ“„ Claim</div>
    <div class="resource-bubble bubble-patient"            onclick="showPasPanel('pas-patient')">ğŸ‘¤ Patient</div>
    <div class="resource-bubble bubble-coverage"           onclick="showPasPanel('pas-coverage')">ğŸ›¡ï¸ Coverage</div>
    <div class="resource-bubble bubble-practitioner"       onclick="showPasPanel('pas-practitioner')">ğŸ‘¨â€âš•ï¸ Practitioner</div>
    <div class="resource-bubble bubble-location"           onclick="showPasPanel('pas-location')">ğŸ“ Location</div>
    <div class="resource-bubble bubble-questionnaireresponse" onclick="showPasPanel('pas-qr')">ğŸ“ QuestionnaireResponse</div>
  </div>

  <!-- PAS Claim Panel -->
  <div class="resource-panel-wrapper">
    <div id="panel-pas-claim" class="resource-panel" style="border-top-color:#38a169;">
      <button class="close-btn" onclick="hidePasPanel('pas-claim')">Ã—</button>
      <h3>ğŸ“„ Claim Resource Mappings (PAS $submit)</h3>
      <table class="pas-mapping-table">
        <tr><th>MCG Auto Auth Field</th><th>FHIR Element</th><th>GuidingCare Source</th><th>Notes</th></tr>
        <tr><td>Episode ID</td><td><span class="inline-code">claim.identifier</span></td><td>Episode ID</td><td>Unique Identifier for a guideline</td></tr>
	<tr><td>Created date time</td><td><span class="inline-code">claim.created</span></td><td>Creation date-time</td><td>Guideline insertion date-time into GC.</td></tr>
        <tr><td>Level of Care</td><td><span class="inline-code">claim.type</span></td><td>Auth Class</td><td>Authorization type classification</td></tr>
        <tr><td>Place of Service</td><td><span class="inline-code">claim.item.locationCodeableConcept</span></td><td>Place of Service</td><td>CMS Place of Service code</td></tr>
        <tr><td>Service Type</td><td><span class="inline-code">claim.item.category</span></td><td>Admit Reason</td><td>Type of service being requested</td></tr>
        <tr><td>Date of Service</td><td><span class="inline-code">claim.item.servicedDate</span></td><td>Auth Notification Date</td><td>Requested date of service</td></tr>
        <tr><td>Diagnosis Codes</td><td><span class="inline-code">claim.diagnosis.diagnosisCodeableConcept</span></td><td>Diagnosis Codes</td><td>ICD-10 codes in diagnosis array</td></tr>
        <tr><td>Procedure Codes</td><td><span class="inline-code">claim.item.productOrService.coding.code</span></td><td>Procedure Code</td><td>CPT/HCPCS codes</td></tr>
        <tr><td>Urgent</td><td><span class="inline-code">claim.priority</span></td><td>Auth Priority (TAT config isExpedited)</td><td>Priority/urgency indicator</td></tr>
<tr><td>Diagnosis codes</td><td><span class="inline-code">claim.diagnosis</span></td><td>Diagnosis codes</td><td>Category in the system, codes in the code.</td></tr>
<tr><td>patient linkage</td><td><span class="inline-code">claim.patient</span></td><td>Reference patient</td><td>Resource patient</td></tr>
<tr><td>organization linkage</td><td><span class="inline-code">claim.insurer</span></td><td>Reference organization</td><td>Resource organization</td></tr>
<tr><td>practitioner linkage</td><td><span class="inline-code">claim.provider</span></td><td>Reference practitioner</td><td>Resource practitioner</td></tr>
<tr><td>facility provider linkage</td><td><span class="inline-code">claim.facility</span></td><td>Reference location</td><td>Resource location</td></tr>
<tr><td>Eligibility details</td><td><span class="inline-code">claim.insurance</span></td><td>Reference coverage</td><td>Resource coverage</td></tr>

        <tr><td>QuestionnaireResponse Linkage</td><td><span class="inline-code">claim.supportingInfo</span></td><td>DTR QuestionnaireResponse</td><td>Reference to QR Bundle</td></tr>
      </table>
    </div>
  </div>

  <!-- PAS Patient Panel -->
  <div class="resource-panel-wrapper">
    <div id="panel-pas-patient" class="resource-panel" style="border-top-color:#38a169;">
      <button class="close-btn" onclick="hidePasPanel('pas-patient')">Ã—</button>
      <h3>ğŸ‘¤ Patient Resource Mappings (PAS $submit)</h3>
      <table class="pas-mapping-table">
        <tr><th>MCG Auto Auth Field</th><th>FHIR Element</th><th>GuidingCare Source</th><th>Notes</th></tr>
        <tr><td>Patient ID</td><td><span class="inline-code">patient.identifier</span></td><td>Altruista ID</td><td>Use "MB" as identifier type code</td></tr>
        <tr><td>Patient First Name</td><td><span class="inline-code">patient.name.given</span></td><td>Patient First Name</td><td>Given name(s)</td></tr>
        <tr><td>Patient Last Name</td><td><span class="inline-code">patient.name.family</span></td><td>Patient Last Name</td><td>Family/surname</td></tr>
        <tr><td>Date of Birth</td><td><span class="inline-code">patient.birthDate</span></td><td>Patient DOB</td><td>Format: YYYY-MM-DD</td></tr>
        <tr><td>Address (Address1)</td><td><span class="inline-code">patient.address.line</span></td><td>Patient Address</td><td>Street address line(s)</td></tr>
        <tr><td>Address (City)</td><td><span class="inline-code">patient.address.city</span></td><td>Patient City</td><td>City name</td></tr>
        <tr><td>Address (State)</td><td><span class="inline-code">patient.address.state</span></td><td>Patient State</td><td>Two-letter state code</td></tr>
        <tr><td>Address (Zipcode)</td><td><span class="inline-code">patient.address.postalCode</span></td><td>Patient Zip</td><td>5 or 9 digit ZIP</td></tr>
        <tr><td>Gender</td><td><span class="inline-code">patient.gender</span></td><td>Patient Gender</td><td>male | female | other | unknown</td></tr>

      </table>
    </div>
  </div>

  <!-- PAS Coverage Panel -->
  <div class="resource-panel-wrapper">
    <div id="panel-pas-coverage" class="resource-panel" style="border-top-color:#38a169;">
      <button class="close-btn" onclick="hidePasPanel('pas-coverage')">Ã—</button>
      <h3>ğŸ›¡ï¸ Coverage Resource Mappings (PAS $submit)</h3>
      <table class="pas-mapping-table">
        <tr><th>MCG Auto Auth Field</th><th>FHIR Element</th><th>GuidingCare Source</th><th>Notes</th></tr>
        <tr><td>Patient Benefit Member ID</td><td><span class="inline-code">coverage.subscriberId</span></td><td>Member ID (configured)</td><td>Subscriber/Member ID</td></tr>
        <tr><td>Benefit Plan Name</td><td><span class="inline-code">coverage.class.value</span> (where class.type.code == "plan")</td><td>Benefit plan (configured)</td><td>Plan name when class type is "plan"</td></tr>
 <tr><td>Benefit Product Name</td><td><span class="inline-code">coverage.class.value</span> (where class.type.code == "subplan")</td><td>Patient Benefit product Data rootname (Level-1) LOB</td><td>subplan name when class type is "subplan"</td></tr>
        <tr><td>Benefit Group ID</td><td><span class="inline-code">NULL</span> (as of now)</td><td>-</td><td>Currently not mapped in MCG Auto Auth</td></tr>
        <tr><td>LOB (Line of Business)</td><td><span class="inline-code">coverage.type</span></td><td>MAC Configuration</td><td>Value which we are passing in the payload need to be configured in the MCG. Considering the text value in type object.</td></tr>
<tr><td>subscriber</span></td><td>Patient reference</td><td>Reference to Patient resource</td><td>Patient details</td></tr>
<tr><td>payor</span></td><td>Organization reference</td><td>Reference to Organization resource</td><td>Organization details (Tenant)</td></tr>
<tr><td>beneficiary</span></td><td>Patient reference</td><td>Reference to patient resource</td><td>Who is getting benefitted?</td></tr>
<tr><td>relationship</span></td><td>Self</td><td>-</td><td>In MCG Auto auth this is optional. GC is not supporting this.</td></tr>
<tr><td>subscriber ID</span></td><td>coverage.subscriber ID</td><td>-</td><td>Need to check the mapping</td></tr>

      </table>
    </div>
  </div>

  <!-- PAS Practitioner Panel -->
  <div class="resource-panel-wrapper">
    <div id="panel-pas-practitioner" class="resource-panel" style="border-top-color:#38a169;">
      <button class="close-btn" onclick="hidePasPanel('pas-practitioner')">Ã—</button>
      <h3>ğŸ‘¨â€âš•ï¸ Practitioner Resource Mappings (PAS $submit)</h3>
      <h4>Requesting Provider</h4>
      <table class="pas-mapping-table">
        <tr><th>MCG Auto Auth Field</th><th>FHIR Element</th><th>GuidingCare Source</th><th>Notes</th></tr>
         <tr><td>Requesting Provider ID</td><td><span class="inline-code">claim.careTeam.role == "ordering physician"</span></td><td>Provider ID</td><td>Need to check with MCG on exact mapping</td></tr>
        <tr><td>Provider First Name</td><td><span class="inline-code">practitioner.name.given</span></td><td>Requesting Provider First Name</td><td>Given name</td></tr>
        <tr><td>Provider Last Name</td><td><span class="inline-code">practitioner.name.family</span></td><td>Requesting Provider Last Name</td><td>Family name</td></tr>
        <tr><td>Address (Address1)</td><td><span class="inline-code">practitioner.address.line</span></td><td>Requesting Provider Address</td><td>Street address</td></tr>
        <tr><td>Address (City)</td><td><span class="inline-code">practitioner.address.city</span></td><td>Requesting Provider City</td><td>City name</td></tr>
        <tr><td>Address (State)</td><td><span class="inline-code">practitioner.address.state</span></td><td>Requesting Provider State</td><td>Two-letter state code</td></tr>
        <tr><td>Address (Zipcode)</td><td><span class="inline-code">practitioner.address.postalCode</span></td><td>Requesting Provider Zip</td><td>5 or 9 digit ZIP</td></tr>
 <tr><td>Address (District)</td><td><span class="inline-code">practitioner.address.district</span></td><td>Requesting Provider district</td><td>District name</td></tr>

      </table>
      <h4 style="margin-top:20px;">Attending Provider</h4>
      <table class="pas-mapping-table">
        <tr><th>MCG Auto Auth Field</th><th>FHIR Element</th><th>GuidingCare Source</th><th>Notes</th></tr>
       <tr><td>Attending Provider</td><td><span class="inline-code">claim.careTeam.role == "attending physician"</span></td><td>Attending Provider Details</td><td>Identified via CareTeam role</td></tr>
        <tr><td>Provider First Name</td><td><span class="inline-code">practitioner.name.given</span></td><td>Attending Provider First Name</td><td>Given name</td></tr>
        <tr><td>Provider Last Name</td><td><span class="inline-code">practitioner.name.family</span></td><td>Attending Provider Last Name</td><td>Family name</td></tr>
        <tr><td>Address (Address1)</td><td><span class="inline-code">practitioner.address.line</span></td><td>Attending Provider Address</td><td>Street address</td></tr>
        <tr><td>Address (City)</td><td><span class="inline-code">practitioner.address.city</span></td><td>Attending Provider City</td><td>City name</td></tr>
        <tr><td>Address (State)</td><td><span class="inline-code">practitioner.address.state</span></td><td>Attending Provider State</td><td>Two-letter state code</td></tr>
        <tr><td>Address (Zipcode)</td><td><span class="inline-code">practitioner.address.postalCode</span></td><td>Attending Provider Zip</td><td>5 or 9 digit ZIP</td></tr>
<tr><td>Address (District)</td><td><span class="inline-code">practitioner.address.district</span></td><td>Attending Provider district</td><td>District name</td></tr>

      </table>
    </div>
  </div>

  <!-- PAS Location Panel -->
  <div class="resource-panel-wrapper">
    <div id="panel-pas-location" class="resource-panel" style="border-top-color:#38a169;">
      <button class="close-btn" onclick="hidePasPanel('pas-location')">Ã—</button>
      <h3>ğŸ“ Location Resource Mappings (PAS $submit)</h3>
      <table class="pas-mapping-table">
        <tr><th>MCG Auto Auth Field</th><th>FHIR Element</th><th>GuidingCare Source</th><th>Notes</th></tr>
        <tr><td>Facility Provider ID</td><td><span class="inline-code">location.identifier.value</span></td><td>Facility Provider NPI</td><td>National Provider Identifier</td></tr>
        <tr><td>Facility Name</td><td><span class="inline-code">location.name</span></td><td>Facility Provider Name</td><td>Name of the facility</td></tr>
        <tr><td>Place of Service</td><td><span class="inline-code">location.type.coding.code</span></td><td>Place of Service Code</td><td>CMS Place of Service code (e.g., 21, 22)</td></tr>
        <tr><td>Address (Address1)</td><td><span class="inline-code">location.address.line</span></td><td>Facility Address</td><td>Street address</td></tr>
        <tr><td>Address (City)</td><td><span class="inline-code">location.address.city</span></td><td>Facility City</td><td>City name</td></tr>
        <tr><td>Address (State)</td><td><span class="inline-code">location.address.state</span></td><td>Facility State</td><td>Two-letter state code</td></tr>
        <tr><td>Address (Zipcode)</td><td><span class="inline-code">location.address.postalCode</span></td><td>Facility Zip</td><td>5 or 9 digit ZIP</td></tr>
      </table>
    </div>
  </div>

  <!-- PAS QR Panel -->
  <div class="resource-panel-wrapper">
    <div id="panel-pas-qr" class="resource-panel" style="border-top-color:#38a169;">
      <button class="close-btn" onclick="hidePasPanel('pas-qr')">Ã—</button>
      <h3>ğŸ“ QuestionnaireResponse Linkage (PAS $submit)</h3>
      <table class="pas-mapping-table">
        <tr><th>MCG Auto Auth Field</th><th>FHIR Element</th><th>GuidingCare Source</th><th>Notes</th></tr>
        <tr><td>QuestionnaireResponse Linkage</td><td><span class="inline-code">claim.supportingInfo</span></td><td>DTR QuestionnaireResponse</td><td>Reference to nested DTR-QRBundle</td></tr>
      </table>
      <div class="alert alert-warning" style="margin-top:15px;">
        <strong>âš ï¸ Important:</strong> QuestionnaireResponse must be wrapped in a nested Bundle with profile <span class="inline-code">DTR-QRBundle</span> before including in the PAS Request Bundle.
      </div>
      <div class="flow-diagram" style="margin-top:15px;">PAS Request Bundle
â”‚
â”œâ”€â”€ Claim
â”‚   â””â”€â”€ supportingInfo â†’ references DTR-QRBundle
â”‚
â””â”€â”€ Bundle (DTR-QRBundle)  â† Nested Bundle!
    â””â”€â”€ QuestionnaireResponse</div>
    </div>
  </div>
</div>

<div class="card" style="margin-top:30px;">
    <h3>ğŸ“‹ Summary: All Open Questions for PAS $submit</h3>
    <h4 style="margin-top:15px;color:#2b6cb0;">ğŸ”µ GuidingCare (GC) Questions:</h4>
    <ol style="margin-left:25px;margin-top:10px;">
      <li>Need to figure out the <strong>Patient MRN</strong> mapping</li>
      <li>Need to determine <strong>Organization resource</strong> mappings</li>
    </ol>
    <h4 style="margin-top:20px;color:#c05621;">ğŸŸ  MCG Questions:</h4>
    <ol style="margin-left:25px;margin-top:10px;">
      <li>Where can we pass the <strong>requestType</strong> in the payload?<div class="answered-block" style="margin-top:6px;">âœ… <strong>Answered:</strong> MCG confirmed there is no mapping. It will fetch requestType from the association of "level of care" &amp; "Service type".</div></li>
      <li>Unable to see the <strong>"provider" field</strong> referenced practitioner anywhere.<div class="answered-block" style="margin-top:6px;">âœ… <strong>Answered:</strong> MCG mentioned provider reference is just for a backup.</div></li>
    </ol>
  </div>
</div>


<!-- ==================== SECTION 8 ==================== -->
<div id="dtr-phase" class="section">
  <h2>8. Phase 1: DTR (Documentation Templates and Rules)</h2>
  <div class="card">
    <h3>Endpoints</h3>
    <table>
      <tr><th>Endpoint</th><th>Purpose</th></tr>
      <tr><td><span class="inline-code">$questionnaire-package</span></td><td>Get questionnaire(s) for a procedure code</td></tr>
      <tr><td><span class="inline-code">$next-question</span></td><td>Get next question in adaptive flow</td></tr>
    </table>
  </div>
  <div class="card">
    <h3>Determine Questionnaire Type</h3>
    <table>
      <tr><th>Scenario</th><th>Response Type</th><th>Profile</th></tr>
      <tr><td>ONE guideline matches</td><td><span class="badge badge-green">Standard</span></td><td><span class="inline-code">dtr-std-questionnaire</span></td></tr>
      <tr><td>MULTIPLE guidelines match</td><td><span class="badge badge-orange">Adaptive</span></td><td><span class="inline-code">dtr-questionnaire-adapt</span></td></tr>
    </table>
  </div>
</div>

<!-- ==================== SECTION 9 ==================== -->
<div id="questionnaire-response" class="section">
  <h2>9. Phase 2: Build QuestionnaireResponse</h2>
  <div class="card">
    <h3>Required Extensions (Minimum 3)</h3>
    <table>
      <tr><th>#</th><th>Extension</th><th>Purpose</th></tr>
      <tr><td>1</td><td><span class="inline-code">qr-context</span></td><td>Coverage reference</td></tr>
      <tr><td>2</td><td><span class="inline-code">qr-context</span></td><td>ServiceRequest reference</td></tr>
      <tr><td>3</td><td><span class="inline-code">intendedUse</span></td><td>How the response will be used</td></tr>
    </table>
  </div>
</div>

<!-- ==================== SECTION 10 ==================== -->
<div id="pas-phase" class="section">
  <h2>10. Phase 3: PAS (Prior Authorization Support)</h2>
  <div class="card">
    <h3>PAS Bundle Structure</h3>
    <div class="flow-diagram">Bundle (profile-pas-request-bundle)
â”‚
â”œâ”€â”€ Claim (the PA request)
â”œâ”€â”€ Coverage
â”œâ”€â”€ Patient
â”œâ”€â”€ Practitioner
â”œâ”€â”€ Location
â”œâ”€â”€ Organization (Insurer)
â””â”€â”€ Bundle (DTR-QRBundle)      â† Nested Bundle!
    â””â”€â”€ QuestionnaireResponse</div>
  </div>
</div>

<!-- ==================== SECTION 11 ==================== -->
<div id="validation-errors" class="section">
 <h2>11. Common Validation Errors &amp; Solutions</h2>

  <div class="error-category">ğŸ“¦ Bundle &amp; Resource ID Errors</div>
  <div class="card">
    <table>
      <tr><th>Error</th><th>Cause</th><th>Solution</th></tr>
      <tr><td>Missing Bundle.identifier (cardinality 1..1)</td><td>Bundle doesn't have an identifier</td><td>Add <span class="inline-code">identifier</span> with system and value to Bundle</td></tr>
      <tr><td>Invalid URI for fullUrl</td><td><span class="inline-code">urn:uuid:ALT241992</span> not valid UUID</td><td>Use proper UUID format: <span class="inline-code">urn:uuid:a1b2c3d4-e5f6-7890-abcd-ef1234567890</span></td></tr>
      <tr><td>ID doesn't match regex <span class="inline-code">[A-Za-z0-9\-\.]{1,64}</span></td><td>ID contains underscore: <span class="inline-code">prov_40907</span></td><td>Replace underscore with hyphen: <span class="inline-code">prov-40907</span></td></tr>
    </table>
    <div class="alert alert-info" style="margin-top:15px;"><strong>FHIR ID Rules:</strong><ul style="margin-left:20px;margin-top:5px;"><li>âœ… <span class="inline-code">prov-40907</span> (hyphen OK)</li><li>âŒ <span class="inline-code">prov_40907</span> (underscore NOT allowed)</li></ul></div>
  </div>

  <div class="error-category">ğŸ¥ NPI Validation Errors</div>
  <div class="card">
    <table>
      <tr><th>Error</th><th>Cause</th><th>Solution</th></tr>
      <tr><td>Invalid NPI (Luhn check failed)</td><td>NPI doesn't pass Luhn algorithm checksum</td><td>Use valid NPIs that pass Luhn validation</td></tr>
    </table>
    <h4 style="margin-top:15px;">Valid Test NPIs:</h4>
    <table>
      <tr><th>NPI</th><th>Status</th></tr>
      <tr><td><span class="inline-code">1234567893</span></td><td><span class="badge badge-green">âœ“ Valid</span></td></tr>
      <tr><td><span class="inline-code">1245319599</span></td><td><span class="badge badge-green">âœ“ Valid</span></td></tr>
      <tr><td><span class="inline-code">1497758544</span></td><td><span class="badge badge-green">âœ“ Valid</span></td></tr>
      <tr><td><span class="inline-code">1003000126</span></td><td><span class="badge badge-green">âœ“ Valid</span></td></tr>
    </table>
  </div>

  <div class="error-category">ğŸ”— Service Type &amp; Level of Care (LOC) Association Errors</div>
  <div class="card">
    <div class="alert alert-info">
      <strong>ğŸ“– How MCG Determines Level of Care (LOC) â€” Multi-Step Evaluation:</strong><br><br>
      As per the MCG PAS Technical Guide, PAS determines LOC from the incoming FHIR Claim using a multi-step evaluation. PAS supports inpatient and outpatient level of care.
      <ol style="margin-left:20px;margin-top:10px;">
        <li style="margin-bottom:8px;"><strong>1st Driver â€” Place of Service:</strong> MCG first looks at <span class="inline-code">claim.item.locationCodeableConcept</span>. If a valid POS code is present and recognized, LOC is derived from it.</li>
        <li style="margin-bottom:8px;"><strong>2nd Driver â€” Service Type:</strong> If Place of Service is absent or insufficient, MCG falls back to <span class="inline-code">claim.item.category</span> (Service Type). This Service Type <strong>must be configured in the Admin Site association (P2)</strong>. If not configured, this fallback also fails.</li>
      </ol>
    </div>
    <h4 style="margin-top:20px;">Error 1 â€” No Active Mapping for ServiceType and LevelOfCare</h4>
    <table>
      <tr><th>Error</th><th>Cause</th><th>Solution</th></tr>
      <tr><td>CareWebQI: No active mapping found for ServiceType and LevelOfCare</td><td>The ServiceType + LevelOfCare combination has no active association in Admin Site</td><td>Admin Site â†’ Customize â†’ Create Association</td></tr>
    </table>
    <pre style="margin-top:15px;">{
  "resourceType": "OperationOutcome",
  "issue": [{
    "severity": "error",
    "code": "exception",
    "details": {
      "text": "CareWebQI: No active mapping found for ServiceType 'Consultation' and LevelOfCare 'Outpatient'"
    }
  }]
}</pre>
    <h4 style="margin-top:20px;">Error 2 â€” Service Type Not Found in Payer System</h4>
    <table>
      <tr><th>Error</th><th>Cause</th><th>Solution</th></tr>
      <tr><td>CareWebQI: Service type '[value]' not found in the payer system</td><td>Service Type value is not recognized or configured in Admin Site. Place of Service also failed as primary driver.</td><td>Verify Service Type display value exactly matches Admin Site configuration (case-sensitive)</td></tr>
    </table>
    <pre style="margin-top:15px;">{
  "resourceType": "OperationOutcome",
  "issue": [{
    "severity": "error",
    "code": "exception",
    "details": {
      "text": "CareWebQI: Service type 'Mail Order Pharmacy' not found in the payer system"
    }
  }]
}</pre>
    <div class="alert alert-success" style="margin-top:15px;"><strong>âœ… How to Fix:</strong> Refer to <strong>Pre-Requisite P2</strong> â€” navigate to <strong>Admin Site â†’ Customize â†’ Create Association</strong> and ensure the Service Type and Level of Care combination is active and matches the payload values exactly.</div>
    <h4 style="margin-top:15px;">What to verify in your payload:</h4>
    <table>
      <tr><th>FHIR Field</th><th>Maps To (LOC Driver)</th><th>Priority</th><th>Example Value</th></tr>
      <tr><td><span class="inline-code">claim.item.locationCodeableConcept</span></td><td>Place of Service â†’ LOC</td><td><span class="badge badge-green">1st (Primary)</span></td><td>code: "21" (Inpatient Hospital)</td></tr>
      <tr><td><span class="inline-code">claim.item.category.coding</span></td><td>Service Type â†’ LOC (via association)</td><td><span class="badge badge-orange">2nd (Fallback)</span></td><td>code: "90", display: "Long Term Care"</td></tr>
    </table>
  </div>

  <div class="error-category">ğŸ“ QuestionnaireResponse Errors</div>
  <div class="card">
    <table>
      <tr><th>Error</th><th>Cause</th><th>Solution</th></tr>
      <tr><td>Instance count is 2, cardinality 3..*</td><td>QuestionnaireResponse needs minimum 3 extensions</td><td>Add all 3 required extensions: 2Ã— qr-context + intendedUse</td></tr>
      <tr><td>Missing answer.extension (information-origin)</td><td>DTR profile requires info-origin on answers</td><td>Add <span class="inline-code">information-origin</span> extension to answers</td></tr>
      <tr><td>dtrx-1: Manual/override source needs author</td><td>Using <span class="inline-code">source: manual</span> without author extension</td><td>Either add author extension OR use <span class="inline-code">source: auto</span></td></tr>
    </table>
    <div class="alert alert-danger" style="margin-top:15px;"><strong>âš  Context Rule:</strong> The <span class="inline-code">information-origin</span> extension is ONLY valid on <span class="inline-code">QuestionnaireResponse.item.answer</span> â€” NOT on nested item answers.</div>
  </div>

  <div class="error-category">ğŸ’Š Claim &amp; Diagnosis Errors</div>
  <div class="card">
    <table>
      <tr><th>Error</th><th>Cause</th><th>Solution</th></tr>
      <tr><td>ICD-10 codes in wrong location</td><td>ICD-10 placed in <span class="inline-code">item.productOrService</span></td><td>Move ICD-10 to <span class="inline-code">Claim.diagnosis[]</span>; keep only CPT in <span class="inline-code">item.productOrService</span></td></tr>
      <tr><td>Missing facility reference</td><td>Claim doesn't reference Location</td><td>Add <span class="inline-code">"facility": { "reference": "Location/xxx" }</span> to Claim</td></tr>
    </table>
  </div>

  <div class="error-category">ğŸ” Coverage &amp; Subscriber Errors</div>
  <div class="card">
    <table>
      <tr><th>Error</th><th>Cause</th><th>Solution</th></tr>
      <tr><td>Invalid subscriber relationship</td><td>Wrong relationship code</td><td>Use: <span class="inline-code">self</span> (18), <span class="inline-code">spouse</span> (01), <span class="inline-code">child</span> (19)</td></tr>
      <tr><td>Missing subscriberId</td><td>Coverage doesn't have subscriber ID</td><td>Add <span class="inline-code">subscriberId</span> field to Coverage</td></tr>
    </table>
  </div>
</div>
  </div>

<!-- ==================== SECTION 12 ==================== -->
<div id="complete-flow" class="section">
  <h2>12. Complete Flow Diagram</h2>
  <div class="card">
    <div class="flow-diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DTR PHASE                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Call $questionnaire-package (CPT code)                         â”‚
â”‚                        â”‚                                            â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚         Standard             Adaptive                               â”‚
â”‚       Questionnaire        Questionnaire                            â”‚
â”‚                                   â”‚                                 â”‚
â”‚                          Call $next-question                        â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                        â–¼                                            â”‚
â”‚            Build QuestionnaireResponse                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PAS PHASE                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  2. Build PAS Bundle â†’ 3. Call $submit â†’ 4. Receive ClaimResponse  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>
  </div>
</div>

<!-- ==================== SECTION 13 ==================== -->
<div id="best-practices" class="section">
  <h2>13. Best Practices</h2>
  <div class="card">
    <table>
      <tr><th>#</th><th>Practice</th><th>Reason</th></tr>
      <tr><td>1</td><td>Always include Patient in $questionnaire-package</td><td>Some guidelines require patient demographics</td></tr>
      <tr><td>2</td><td>Use valid NPIs (Luhn validated)</td><td>Invalid NPIs cause validation failures</td></tr>
      <tr><td>3</td><td>Keep CPT and ICD-10 separate</td><td>CPT in item.productOrService, ICD-10 in diagnosis</td></tr>
      <tr><td>4</td><td>Use hyphens not underscores in IDs</td><td>FHIR regex doesn't allow underscores</td></tr>
      <tr><td>5</td><td>Wrap QuestionnaireResponse in DTR-QRBundle</td><td>PAS profile requires nested bundle structure</td></tr>
    </table>
  </div>
</div>

<!-- ==================== SECTION 14 ==================== -->
<div id="api-summary" class="section">
  <h2>14. API Endpoints Summary</h2>
  <div class="card">
    <table>
      <tr><th>Phase</th><th>Endpoint</th><th>Method</th><th>Purpose</th></tr>
      <tr><td><span class="badge badge-blue">DTR</span></td><td><span class="inline-code">/Questionnaire/$questionnaire-package</span></td><td>POST</td><td>Get questionnaire</td></tr>
      <tr><td><span class="badge badge-blue">DTR</span></td><td><span class="inline-code">/Questionnaire/$next-question</span></td><td>POST</td><td>Adaptive flow</td></tr>
      <tr><td><span class="badge badge-green">PAS</span></td><td><span class="inline-code">/Claim/$submit</span></td><td>POST</td><td>Submit PA request</td></tr>
      <tr><td><span class="badge badge-orange">CareWebQI</span></td><td><span class="inline-code">/CareWebQI/{episodeId}</span></td><td>GET</td><td>Get guideline outcomes</td></tr>
    </table>
  </div>
</div>

<!-- ==================== SECTION 15 ==================== -->
<div id="identifiers" class="section">
  <h2>15. Key Identifiers to Track</h2>
  <div class="card">
    <table>
      <tr><th>Identifier</th><th>Where It's Set</th><th>Purpose</th></tr>
      <tr><td>Transaction ID (tid)</td><td>In questionnaire URL</td><td>Links DTR session</td></tr>
      <tr><td>Episode ID</td><td>Claim.identifier</td><td>MCG case tracking</td></tr>
      <tr><td>preAuthRef</td><td>ClaimResponse</td><td>Authorization reference number</td></tr>
    </table>
  </div>
</div>

<!-- ==================== SECTION 16 ==================== -->
<div id="sample-payload" class="section">
  <h2>16. Sample PAS $submit Payload</h2>
  <div class="alert alert-info"><strong>ğŸ“Œ About this Sample:</strong> Working example for <span class="inline-code">POST /Claim/$submit</span>. Includes all key resources. You can select all text inside the code block and copy it.</div>
  <div class="card">
    <h3>ğŸ“¦ Resources Included</h3>
    <table>
      <tr><th>Resource</th><th>Details</th></tr>
      <tr><td><span class="badge badge-purple">Claim</span></td><td>Institutional, Service Type: Hospital Room and Board (49), CPT: 27125, POS: 21</td></tr>
      <tr><td><span class="badge badge-green">Patient</span></td><td>Member ID: ALT241992, DOB: 2003-08-22, Gender: Male</td></tr>
      <tr><td><span class="badge badge-purple">Coverage</span></td><td>LOB: Altruists Health Assurance, Plan: Medicare, Subscriber ID: medi7979</td></tr>
      <tr><td><span class="badge badge-orange">Practitioner (Attending)</span></td><td>NPI: 1245319599, Role: Attending Physician</td></tr>
      <tr><td><span class="badge badge-orange">Practitioner (Requesting)</span></td><td>NPI: 1003000126, Role: Ordering Physician</td></tr>
      <tr><td style="background:#e6fffa;"><span class="badge" style="background:#81e6d9;color:#234e52;">Organization</span></td><td>NPI: 1497758544, Test MCG Insurance</td></tr>
      <tr><td><span class="badge badge-red">Location</span></td><td>NPI: 1003000126, Gotham General, Seattle WA</td></tr>
      <tr><td style="background:#fed7e2;"><span class="badge" style="background:#fbb6ce;color:#97266d;">QuestionnaireResponse</span></td><td>Hip Arthroplasty guideline, status: completed</td></tr>
    </table>
    <div class="payload-wrapper">
      <pre class="payload-pre">{
  "resourceType": "Bundle",
  "id": "a465ffaa-5936-4d98-9c3c-c94df1445233",
  "meta": {
    "profile": ["http://hl7.org/fhir/us/davinci-pas/StructureDefinition/profile-pas-request-bundle"]
  },
  "identifier": {
    "system": "https://guidingcare.healthedge.com/pas-bundle/submitter_transaction_identifier",
    "value": "a465ffaa-5936-4d98-9c3c-c94df1445233"
  },
  "type": "collection",
  "timestamp": "2025-12-02T19:24:14.842Z",
  "entry": [
    {
      "fullUrl": "urn:uuid:59380def-ff86-42b8-be7b-5c69db2440b3",
      "resource": {
        "resourceType": "Claim",
        "id": "59380def-ff86-42b8-be7b-5c69db2440b3",
        "meta": { "profile": ["http://hl7.org/fhir/us/davinci-pas/StructureDefinition/profile-claim"] },
        "identifier": [{ "system": "urn:trnorg:15", "use": "usual", "value": "9381824042" }],
        "status": "active",
        "type": { "coding": [{ "system": "http://terminology.hl7.org/CodeSystem/claim-type", "code": "institutional", "display": "Institutional" }] },
        "use": "preauthorization",
        "patient": { "reference": "Patient/b1c2d3e4-f5a6-7890-abcd-ef1234567890" },
        "created": "2025-10-08",
        "insurer": { "reference": "Organization/67541c1c-a494-4d0e-8620-a36d49f25cbd" },
        "provider": { "reference": "Practitioner/a1b2c3d4-e5f6-7890-abcd-ef1234567003" },
        "facility": { "reference": "Location/37a1711e-9bc2-4932-8d34-aa27ecbaf2ed" },
        "priority": { "coding": [{ "system": "http://terminology.hl7.org/CodeSystem/processpriority", "code": "normal" }] },
        "careTeam": [
          {
            "extension": [{ "url": "http://hl7.org/fhir/us/davinci-pas/StructureDefinition/extension-careTeamClaimScope", "valueBoolean": true }],
            "sequence": 1,
            "provider": { "reference": "Practitioner/77264e71-28d7-4e15-932e-ab7a970f2bd5" },
            "role": { "coding": [{ "system": "https://codesystem.x12.org/005010/98", "code": "71", "display": "Attending Physician" }] }
          },
          {
            "extension": [{ "url": "http://hl7.org/fhir/us/davinci-pas/StructureDefinition/extension-careTeamClaimScope", "valueBoolean": true }],
            "sequence": 2,
            "provider": { "reference": "Practitioner/ordering-prov-901746646" },
            "role": { "coding": [{ "system": "https://codesystem.x12.org/005010/98", "code": "DK", "display": "Ordering Physician" }] }
          }
        ],
        "supportingInfo": [
          {
            "sequence": 1,
            "category": { "coding": [{ "system": "http://hl7.org/fhir/us/davinci-pas/CodeSystem/PASSupportingInfoType", "code": "additionalInformation" }] },
            "valueReference": { "reference": "QuestionnaireResponse/qr-hip-arthroplasty-approved" }
          }
        ],
        "insurance": [{ "sequence": 1, "focal": true, "coverage": { "reference": "Coverage/e0470f2a-7870-4d7a-8d24-6aff814000c6" } }],
        "diagnosis": [
          { "sequence": 1, "diagnosisCodeableConcept": { "coding": [{ "system": "http://hl7.org/fhir/sid/icd-10-cm", "code": "J11.08", "display": "Influenza due to unidentified influenza virus with specified pneumonia" }] } },
          { "sequence": 2, "diagnosisCodeableConcept": { "coding": [{ "system": "http://hl7.org/fhir/sid/icd-10-cm", "code": "E08.42", "display": "Diabetes mellitus due to underlying condition with diabetic polyneuropathy" }] } }
        ],
        "item": [
          {
            "extension": [
              { "url": "http://hl7.org/fhir/us/davinci-pas/StructureDefinition/extension-serviceItemRequestType", "valueCodeableConcept": { "coding": [{ "system": "https://codesystem.x12.org/005010/1525", "code": "HS", "display": "Health Services Review" }] } },
              { "url": "http://hl7.org/fhir/us/davinci-pas/StructureDefinition/extension-certificationType", "valueCodeableConcept": { "coding": [{ "system": "https://codesystem.x12.org/005010/1322", "code": "I", "display": "Initial" }] } }
            ],
            "sequence": 1,
            "careTeamSequence": [1, 2],
            "diagnosisSequence": [1, 2],
            "informationSequence": [1],
            "category": { "coding": [{ "system": "https://codesystem.x12.org/005010/1365", "code": "49", "display": "Hospital Room and Board" }] },
            "productOrService": { "coding": [{ "system": "http://www.ama-assn.org/go/cpt", "code": "27125", "display": "Inpatient admission" }] },
            "servicedDate": "2025-12-04",
            "locationCodeableConcept": { "coding": [{ "system": "https://www.cms.gov/Medicare/Coding/place-of-service-codes/Place_of_Service_Code_Set", "code": "21", "display": "Inpatient Hospital" }] }
          }
        ]
      }
    },
    {
      "fullUrl": "urn:uuid:b1c2d3e4-f5a6-7890-abcd-ef1234567890",
      "resource": {
        "resourceType": "Patient",
        "id": "b1c2d3e4-f5a6-7890-abcd-ef1234567890",
        "meta": { "profile": ["http://hl7.org/fhir/us/davinci-pas/StructureDefinition/profile-beneficiary"] },
        "identifier": [{ "use": "official", "type": { "coding": [{ "system": "http://terminology.hl7.org/CodeSystem/v2-0203", "code": "MB", "display": "Member Number" }] }, "system": "https://guidingcare.healthedge.com/member-id", "value": "ALT241992" }],
        "active": true,
        "name": [{ "use": "official", "family": "Durga Vijay", "given": ["Pulavarti"] }],
        "telecom": [{ "system": "phone", "value": "432-894-5829", "use": "mobile" }],
        "gender": "male",
        "birthDate": "2003-08-22",
        "address": [{ "use": "home", "type": "physical", "line": ["Sasi vihar apartments"], "city": "Velivennu", "state": "AR", "postalCode": "53432", "district": "US" }]
      }
    },
    {
      "fullUrl": "urn:uuid:e0470f2a-7870-4d7a-8d24-6aff814000c6",
      "resource": {
        "resourceType": "Coverage",
        "id": "e0470f2a-7870-4d7a-8d24-6aff814000c6",
        "meta": { "profile": ["http://hl7.org/fhir/us/davinci-pas/StructureDefinition/profile-coverage"] },
        "type": { "coding": [{ "system": "http://terminology.hl7.org/CodeSystem/v3-ActCode", "code": "MD", "display": "Altruists Health Assurance" }], "text": "Altruists Health Assurance" },
        "status": "active",
        "subscriber": { "reference": "Patient/b1c2d3e4-f5a6-7890-abcd-ef1234567890" },
        "subscriberId": "medi7979",
        "beneficiary": { "reference": "Patient/b1c2d3e4-f5a6-7890-abcd-ef1234567890" },
        "relationship": { "coding": [{ "system": "http://terminology.hl7.org/CodeSystem/subscriber-relationship", "code": "self", "display": "Self" }] },
        "payor": [{ "reference": "Organization/67541c1c-a494-4d0e-8620-a36d49f25cbd" }],
        "class": [
          { "type": { "coding": [{ "system": "http://terminology.hl7.org/CodeSystem/coverage-class", "code": "plan" }] }, "value": "Medicare", "name": "Medicare" },
          { "type": { "coding": [{ "system": "http://terminology.hl7.org/CodeSystem/coverage-class", "code": "subplan" }] }, "value": "Level-1 Data root name", "name": "GoodbenefitPlan" }
        ]
      }
    },
    {
      "fullUrl": "urn:uuid:77264e71-28d7-4e15-932e-ab7a970f2bd5",
      "resource": {
        "resourceType": "Practitioner",
        "id": "77264e71-28d7-4e15-932e-ab7a970f2bd5",
        "meta": { "profile": ["http://hl7.org/fhir/us/davinci-pas/StructureDefinition/profile-practitioner"] },
        "identifier": [{ "system": "http://hl7.org/fhir/sid/us-npi", "value": "1245319599" }],
        "active": true,
        "name": [{ "use": "official", "family": "Ravi teja", "given": ["Pulavarti"] }],
        "telecom": [{ "system": "phone", "value": "938-182-4042", "use": "work" }],
        "address": [{ "line": ["MAX Hospitals"], "use": "work", "city": "Bhubhaneswar", "state": "OH", "postalCode": "53432", "district": "Undrajavaram" }]
      }
    },
    {
      "fullUrl": "urn:uuid:b2c3d4e5-f6a7-8901-bcde-f01234567004",
      "resource": {
        "resourceType": "Practitioner",
        "id": "ordering-prov-901746646",
        "meta": { "profile": ["http://hl7.org/fhir/us/davinci-pas/StructureDefinition/profile-practitioner"] },
        "identifier": [{ "system": "http://hl7.org/fhir/sid/us-npi", "value": "1003000126" }],
        "active": true,
        "name": [{ "use": "official", "family": "Patel", "given": ["Rajesh", "M"] }],
        "telecom": [{ "system": "phone", "value": "555-345-6789", "use": "work" }],
        "address": [{ "line": ["USA Line Hospitals"], "use": "work", "city": "Portland", "state": "OR", "postalCode": "97201", "district": "Velivennu Mandal" }]
      }
    },
    {
      "fullUrl": "urn:uuid:67541c1c-a494-4d0e-8620-a36d49f25cbd",
      "resource": {
        "resourceType": "Organization",
        "id": "67541c1c-a494-4d0e-8620-a36d49f25cbd",
        "meta": { "profile": ["http://hl7.org/fhir/us/davinci-pas/StructureDefinition/profile-insurer"] },
        "identifier": [{ "system": "http://hl7.org/fhir/sid/us-npi", "value": "1497758544" }],
        "active": true,
        "type": [{ "coding": [{ "system": "https://codesystem.x12.org/005010/98", "code": "PR" }] }],
        "name": "Test MCG Insurance",
        "address": [{ "line": ["3419 Tyler Avenue"], "city": "Miami", "state": "FL", "postalCode": "33176", "country": "US" }]
      }
    },
    {
      "fullUrl": "urn:uuid:37a1711e-9bc2-4932-8d34-aa27ecbaf2ed",
      "resource": {
        "resourceType": "Location",
        "id": "37a1711e-9bc2-4932-8d34-aa27ecbaf2ed",
        "meta": { "profile": ["http://hl7.org/fhir/us/davinci-pas/StructureDefinition/profile-location"] },
        "identifier": [{ "system": "http://hl7.org/fhir/sid/us-npi", "value": "1003000126" }],
        "status": "active",
        "name": "Gotham General",
        "address": { "type": "physical", "line": ["701 5th Ave Ste. 4900"], "city": "Seattle", "state": "WA", "postalCode": "98104", "district": "facility district" }
      }
    },
    {
      "fullUrl": "urn:uuid:e1ed230e-55a7-415b-ade3-a1e4404ab7d8",
      "resource": {
        "resourceType": "QuestionnaireResponse",
        "id": "qr-hip-arthroplasty-approved",
        "meta": { "profile": ["http://hl7.org/fhir/us/davinci-dtr/StructureDefinition/dtr-questionnaireresponse"] },
        "questionnaire": "http://www.mcg.com/model/questionnaire/29.0/ISC/0109100a?tid=e3e10a37-8948-41f7-a984-81b54da1f6d2&qid=8a58c4cc-fe13-4302-a98b-59c0b8454225&docDx=false",
        "status": "completed",
        "subject": { "reference": "Patient/b1c2d3e4-f5a6-7890-abcd-ef1234567890" },
        "authored": "2025-02-10T10:30:00Z",
        "author": { "reference": "Practitioner/a1b2c3d4-e5f6-7890-abcd-ef1234567003" },
        "extension": [
          { "url": "http://hl7.org/fhir/us/davinci-dtr/StructureDefinition/qr-context", "valueReference": { "reference": "Claim/59380def-ff86-42b8-be7b-5c69db2440b3" } },
          { "url": "http://hl7.org/fhir/us/davinci-dtr/StructureDefinition/qr-context", "valueReference": { "reference": "ServiceRequest/c1d2e3f4-a5b6-7890-cdef-0123456789cd" } },
          { "url": "http://hl7.org/fhir/us/davinci-dtr/StructureDefinition/intendedUse", "valueCodeableConcept": { "coding": [{ "system": "http://hl7.org/fhir/us/davinci-crd/CodeSystem/temp", "code": "withorder", "display": "Include with order" }] } }
        ],
        "item": [
          {
            "linkId": "7AEB32D7BD8E52C7",
            "text": "The procedure is/was needed for appropriate care of the patient because of",
            "item": [
              {
                "linkId": "7AEB32D7BD8E52C7-F1CFC1157962C1F3",
                "text": "Degenerative joint disease, as indicated by",
                "item": [
                  { "linkId": "7AEB32D7BD8E52C7-F1CFC1157962C1F3-B364E75DE2C12882", "text": "Moderate to severe radiographic findings", "answer": [{ "valueBoolean": true }] },
                  { "linkId": "7AEB32D7BD8E52C7-F1CFC1157962C1F3-A55F1C9F7887ED14", "text": "Medical management has been tried and failed.", "answer": [{ "valueBoolean": true }] },
                  {
                    "linkId": "7AEB32D7BD8E52C7-F1CFC1157962C1F3-4AB3FCA89BD2157E",
                    "text": "Arthroplasty indicated due to",
                    "item": [
                      { "linkId": "7AEB32D7BD8E52C7-F1CFC1157962C1F3-4AB3FCA89BD2157E-6FE3FD48FD02D676", "text": "Moderate to severe pain", "answer": [{ "valueBoolean": true }] },
                      { "linkId": "7AEB32D7BD8E52C7-F1CFC1157962C1F3-4AB3FCA89BD2157E-CBCEFE8095B0DAB9", "text": "Functional disability", "answer": [{ "valueBoolean": true }] }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    }
  ]
}</pre>
    </div>
  </div>
</div>

<div style="text-align:center;margin-top:40px;padding:20px;background:#edf2f7;border-radius:8px;">
  <p style="color:#718096;margin:0;"><strong>Document Version:</strong> 2.5 | <strong>Last Updated:</strong> February 2026</p>
  <p style="color:#a0aec0;margin-top:5px;font-size:14px;">Created by: Durga Vijay Pulavarti</p>
</div>

<script>
  var activePanel = null;
  var activePasPanel = null;

  function showPanel(r) {
    // Close current if open
    if (activePanel) {
      document.getElementById('panel-' + activePanel).classList.remove('active');
      var oldBubble = document.querySelector('#section4-bubbles .bubble-' + activePanel);
      if (oldBubble) oldBubble.classList.remove('active');
    }
    // Toggle off if same bubble clicked
    if (activePanel === r) { activePanel = null; return; }
    // Open new
    document.getElementById('panel-' + r).classList.add('active');
    var newBubble = document.querySelector('#section4-bubbles .bubble-' + r);
    if (newBubble) newBubble.classList.add('active');
    activePanel = r;
    document.getElementById('panel-' + r).scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  }

  function hidePanel(r) {
    document.getElementById('panel-' + r).classList.remove('active');
    var bubble = document.querySelector('#section4-bubbles .bubble-' + r);
    if (bubble) bubble.classList.remove('active');
    activePanel = null;
  }

  function showPasPanel(r) {
    if (activePasPanel) {
      document.getElementById('panel-' + activePasPanel).classList.remove('active');
      var oldBubble = document.querySelector('#section7-bubbles .bubble-' + activePasPanel.replace('pas-',''));
      if (oldBubble) oldBubble.classList.remove('active');
    }
    if (activePasPanel === r) { activePasPanel = null; return; }
    document.getElementById('panel-' + r).classList.add('active');
    activePasPanel = r;
    document.getElementById('panel-' + r).scrollIntoView({ behavior: 'smooth', block: 'nearest' });
  }

  function hidePasPanel(r) {
    document.getElementById('panel-' + r).classList.remove('active');
    activePasPanel = null;
  }
</script>
</body>
</html>
